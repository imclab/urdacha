<!doctype html>
<html lang='en'>
<head>
<title>globe black shaders stars flags</title>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0'>
</head>
<body>

<script src='http://mrdoob.github.com/three.js/examples/js/Detector.js'></script>
<script src='http://mrdoob.github.com/three.js/build/three.min.js'></script>
<script src='http://mrdoob.github.com/three.js/examples/js/controls/TrackballControls.js'></script>
<script src='http://mrdoob.github.com/three.js/examples/js/libs/stats.min.js'></script>

<!--
<script src='../../../three.js/examples/js/Detector.js'></script>
<script src='../../../three.js/build/three.min.js'></script>
<script src='../../../three.js/examples/js/controls/TrackballControls.js'></script>
<script src='../../../three.js/examples/js/libs/stats.min.js'></script>
-->
<script type='text/javascript'>
	if ( ! Detector.webgl ) { Detector.addGetWebGLMessage(); }

	var renderer, scene, camera, controls, light, stats;
	var geometry, material, mesh;

	init();
	animate();
  
	function init() {
		if ( ! Detector.webgl ) {
			renderer = new THREE.CanvasRenderer( { antialias: true } );
		} else {
			renderer = new THREE.WebGLRenderer( { antialias: true } );
		}
		renderer.setSize( window.innerWidth, window.innerHeight );
		//renderer.autoClear = false;
		//renderer.setClearColorHex(0x000000, 0.0);
		document.body.appendChild( renderer.domElement );

		scene = new THREE.Scene();

		camera = new THREE.PerspectiveCamera( 100, window.innerWidth / window.innerHeight, 1, 10000 );
		camera.position.set( 120, 130, 100);

		controls = new THREE.TrackballControls( camera, renderer.domElement );
		controls.minDistance = 10;
		controls.maxDistance = 60;

		stats = new Stats();
		stats.domElement.style.cssText = 'position: absolute; top: 0px; zIndex: 100; ';
		document.body.appendChild( stats.domElement );    

		window.addEventListener( 'resize', onWindowResize, false );

//  User stuff
		document.body.style.cssText = 'background-color: #000; color: #fff; font: 600 12pt monospace; margin: 0; overflow: hidden; text-align: center';

		var css = document.createElement('style')
		css.innerHTML = 'a { text-decoration: none;} ';
		document.body.appendChild( css );


		var info = document.body.appendChild( document.createElement( 'div' ) );
		info.style.cssText = 'top: 0px; padding: 5px; position: absolute; width: 100%';
		info.innerHTML = '<p>view from inside the globe</p>';   

		geometry = new THREE.SphereGeometry( 60, 40, 30 );
		// var texture = THREE.ImageUtils.loadTexture( '../../images/earth_atmos_2048.jpg' );
		var texture = THREE.ImageUtils.loadTexture( '../../images/world-map.gif' );
		
		material = new THREE.MeshBasicMaterial( { color: 0xbbbbbb, map: texture, side: THREE.DoubleSide } );
		
		mesh = new THREE.Mesh( geometry, material );
		scene.add( mesh );
		

		var d2r = Math.PI / 180;
		var zurich = new THREE.Object3D;
		scene.add(zurich);
		makeFlagAndPole( '../../images/ch-zh.gif', zurich, 1 );
		zurich.rotation.set( 0, (180 + 8.5) * d2r, (90 - 47.3690) * d2r );

		var geneva = new THREE.Object3D;
		scene.add(geneva);
		makeFlagAndPole( '../../images/ch-ge.gif', geneva, 1 );
		geneva.rotation.set( 0, (180 + 6) * d2r, (90 - 46) * d2r );	
		
		var sanFrancisco = new THREE.Object3D;
		scene.add(sanFrancisco);
		makeFlagAndPole( '../../images/us-ca-sf.gif', sanFrancisco, 1.5 );
		sanFrancisco.rotation.set( 0, (180 - 122.41) * d2r, (90 - 37.77) * d2r );		
		
	}
	
	function makeFlagAndPole( image, group, proportion ) {
		// pole
		geometry = new THREE.CubeGeometry( 1, 30, 1 );
		material = new THREE.MeshBasicMaterial( {color: 0xaaaaaa } );
		mesh = new THREE.Mesh( geometry, material );
		mesh.position.set(0,45,0);
		group.add( mesh );
		
		// flag
		geometry = new THREE.PlaneGeometry( 20 * proportion, 20, 1, 1 );
		var texture = THREE.ImageUtils.loadTexture( image );
		material = new THREE.MeshBasicMaterial( { color: 0xbbbbbb, ambient: 0xaaaaaa, map: texture, side: THREE.DoubleSide } );
		
		mesh = new THREE.Mesh( geometry, material );
		mesh.position.set( 5 * proportion + 0.55, 35, 0);
		group.add( mesh );
	}

	function animate() {
		requestAnimationFrame( animate );
		controls.update();

		renderer.render( scene, camera );
		stats.update();
	}

	function onWindowResize() {
		windowHalfX = window.innerWidth / 2;
		windowHalfY = window.innerHeight / 2;
		camera.aspect = window.innerWidth / window.innerHeight;
		camera.updateProjectionMatrix();
		renderer.setSize( window.innerWidth, window.innerHeight );
	}
</script>
</body>
</html>